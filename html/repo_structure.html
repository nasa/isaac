<!-- HTML header for doxygen 1.9.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ISAAC: Repository Structure</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.png" type="image/png" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="freeflyer.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 70px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ISAAC
   &#160;<span id="projectnumber">0.2.7</span>
   </div>
   <div id="projectbrief">Flight software for the ISAAC project, adding functionality to the Astrobee robot, operating inside the International Space Station.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('repo_structure.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Repository Structure </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2><a class="anchor" id="autotoc_md30"></a>
Folder description</h2>
<p>The <code>isaac</code> folder is the primary entry point into flight software. For example, if you run <code>roslaunch isaac &lt;launch_file&gt;</code> you are instructing ROS to examine the 'launch' directory in this folder for a XML file called <code>&lt;launch_file&gt;</code>, which describes how to start a specific experiment.</p>
<ol type="1">
<li><code>config</code> - This folder holds all of the configuration files for flight software.</li>
<li><code>launch</code> - Used to launch the flight software stack. Most nodes export also export their own launch and test files.</li>
<li><code>plans</code> - This folder holds plans, which are built using the Ground Data System (GDS) user interface tool.</li>
<li><code>resources</code> - A directory containing all non-LUA resources used by nodes in the system. Additional files might be needed depending on the context.</li>
<li><code>scripts</code> - A simple bash script to print out the environment variables, which can be used to check the context at any point in the launch sequence.</li>
</ol>
<h2><a class="anchor" id="autotoc_md31"></a>
Environment variables</h2>
<ul>
<li><code>ISAAC_RESOURCE_DIR</code>: An absolute path to all non-LUA system resources that are used by the nodes in the system. For example, this includes sparse maps, zone files, clutter maps, etc.</li>
<li><code>ISAAC_CONFIG_DIR</code>: An absolute path to all LUA config files that store input parameters for the nodes in the system.</li>
</ul>
<h2><a class="anchor" id="autotoc_md32"></a>
Context determination</h2>
<p>When launched, nodes must know the context in which they are being launched in order to operate correctly. By context, we mean (a) the robot class being run, (b) the world in which the robot is being run, and (c) paths to both a LUA config and a resource directory. You have flexibility in how this is specified, but note that we enforce the following strict precedence: </p><pre class="fragment">/etc &gt; environment variable &gt; roslaunch arguments &gt; default roslaunch values
</pre><p>For example, consider this launch process run on your local desktop (in this case there will be no <code>/etc/robotname</code> file set by default) </p><pre class="fragment">export ASTROBEE_ROBOT=p4d
roslaunch isaac sim.launch
</pre><p>Based on the precedence rules, the environment variable will take precedence over the roslaunch arguments. So, the ROS argument will be completely ignored and a p4d robot will be launched. We advise that, unless you are doing a battery of tests with the same context and want to avoid long roslaunch argument lists, steer clear of environment variables.</p>
<p>The launch is carried out using the hierarchy of launch files shown below. As a developer you can choose to launch at any points marked with a <code>[*]</code>. As a convention, the context is passed down the hierarchy. </p><pre class="fragment">[sim]                                      [*]
    -&gt; [isaac_astrobee]                    [*]
        -&gt; [glp]
            -&gt; [node]                      [*]
        -&gt; [ilp]
            -&gt; [node] : [ff_nodelet]       [*]
        -&gt; [astrobee]
            -&gt; ...                         [*]
</pre><p>At the package level, ilp nodes inherit from ff_nodelet, and are launched using a pattern defined by ff_nodelet.launch. This pattern respects our context determination hierarchy. glp nodes do not inherit from ff_nodelet, and are meant for general robot functionality.</p>
<h2><a class="anchor" id="autotoc_md33"></a>
Default contexts</h2>
<p>Assuming no environment variables are set or <code>/etc</code> files are created, the default contexts defined by the launch files are the following:</p>
<ul>
<li><code>isaac_astrobee.launch</code>: robot = {argument}, world = iss, drivers = true</li>
<li><code>sim.launch</code>: robot = sim, world = granite, drivers = false</li>
</ul>
<h2><a class="anchor" id="autotoc_md34"></a>
Remotely launching nodes</h2>
<p>It is possible to launch the GLP, ILP, MLP, LLP and simulator on remote devices. The corresponding arguments are <code>glp:=&lt;ip&gt;</code>, <code>ilp:=&lt;ip&gt;</code>, <code>mlp:=&lt;ip&gt;</code>, <code>llp:=&lt;ip&gt;</code> and <code>sim:=&lt;ip&gt;</code>. There are two special values for <code>&lt;ip&gt;</code>:</p>
<ul>
<li>ip = <code>local</code> : launch on the local machine</li>
<li>ip = <code>disabled</code> : disable this machine completely.</li>
</ul>
<p>The {llp,mlp,sim} arguments with {IP,local,disabled} options is very powerful and supports any configuration of robot with simulated nodes or hardware in the loop.</p>
<h2><a class="anchor" id="autotoc_md35"></a>
Launching only specific nodes</h2>
<p>It is possible to specify on the command line the set of nodes to be launched using the <code>nodes:=&lt;comma_separated_list_of_nodes&gt;</code> argument.</p>
<p>In this case, only the provided nodes will be launched on their destination processors (llp or mlp). In addition, it is possible to avoid roslaunch to perform any connection to a particular processor with the declaration <code>{llp,mlp}:=disabled</code>. This is particularly useful if you need to test some nodes on one processor and do not have access to the other processor.</p>
<p>For example, to test only the picoflexx cameras on the MLP, not attempting connection to the LLP (in case it is absent from the test rig): </p><pre class="fragment">roslaunch isaac isaac_astrobee.launch llp:=disabled nodes:=pico_driver,framestore
</pre><h2><a class="anchor" id="autotoc_md36"></a>
Launch file examples</h2>
<ol type="1">
<li><p class="startli">Start a local iss simulation with one p4d robot on namespace '/'</p>
<p class="startli">roslaunch isaac isaac_astrobee.launch</p>
</li>
<li><p class="startli">Start with rviz on, the streaming mapper on, and with the robot undocked at a given position:</p>
<p class="startli">roslaunch isaac sim.launch world:=iss rviz:=true streaming_mapper:=true \ pose:="11.0 -7.0 5.0 0 0 0 1"</p>
</li>
</ol>
<p>See </p><pre class="fragment">dense_map/geometry_mapper/readme.md
</pre><p>for how to enable the sci cam in simulation and have it publish pictures before running the above command, and more details about the streaming mapper.</p>
<p>If the bot is started docked, hence without specifying the pose as above, it can be undocked with the command:</p>
<p>rosrun dock dock_tool -undock <br  />
</p>
<p>and then the bot can be moved via: </p><pre class="fragment">rosrun mobility teleop -move -pos "11.0 -5.0 5.0" -tolerance_pos 0.0001 -att "0 0 0 1"
</pre><ol type="1">
<li><p class="startli">ISAAC supports a simulated acoustics camera. See:</p>
<p class="startli">astrobee/simulation/acoustics_cam/readme.md</p>
</li>
</ol>
<p>for how to use it with the simulator. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.0-->
<!-- start footer part -->
</body>
</html>
